<!DOCTYPE html>
<html lang="pt-Br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./style.css">
  <link rel="shortcut icon" href="./Assets/M.ico" type="image/x-icon">
  <title>Lista de indica√ß√µes</title>
</head>
<!-- Script que fixa os bot√µes no topo da pagina ao rolar a p√°gina.[Inicio] -->
<script type="text/javascript">
  window.onscroll = scroll;
  function scroll() {
    var nVScroll = document.documentElement.scrollTop || document.body.scrollTop; if (nVScroll > 100) {
      document.getElementById("item1").classList.add('menuFixo');
    } else { document.getElementById("item1").classList.remove('menuFixo'); }
    
  }

  /* Script que fixa os bot√µes no topo da pagina ao rolar a p√°gina.[Fim] */

</script>


<body>

  <section class="container">

    <header class="header-content">

      <div><img class="imgHeader" src="./Assets/LogoMeet-New.png" alt="" srcset=""></div>
      <div>
        <h1>Meet <span>News</span>üóûÔ∏è</h1>
      </div>
      <div><span id="dataHora"></span></div>

    </header>

    <main class="main-content">


      <div id="item1" class="item1">

        <div class="buttons"><img class="imgItem1" src="./Assets/LogoMeet-New.png" width="40" height="40" alt=""
            srcset=""></div>
        <div class="buttons"><button class="btn btnPortaria">Portaria</button></div>
        <div class="buttons"><button class="btn btnIndicacoes">Indica√ß√µes</button></div>
        <div class="buttons"><button class="btn btnAssembleias">Assembleias</button></div>
        <div class="buttons"><button class="btn btnPaterns">Paterns</button></div>

      </div>


      <div class="itens item2">
        <button class="addBtn" onclick="openModalNew()"><img src="./Assets/btnAdd32.png" alt="" srcset=""></button>
        <!-- Modal para adicionar as noticias na tela [Inicio] -->
        <div class="modalContent" id="showModal">
          <div class="modal">
            <label for="data">Data</label>
            <input type="text" name="data" id="data">

            <label id="nome">T√≠tulo</label>
            <input type="text" id="nome">

            <label for="data">Conte√∫do</label>
            <input type="text" name="data" id="data">

            <button id="AddBtn">Adiciona</button>
            <button id="AddBtn">Deleta</button>
            <button id="AddBtn">Corrige</button>
            <button id="Retorna">Retorna</button>
          </div>
        </div>
        <!-- Modal para adicionar as noticias na tela [Fim] -->

        <!-- √Årea do conte√∫do da p√°gina -->
        <div id="contentPost" class="post-container"></div>

      </div>

    </main>

    <footer class="footer-content">

      <div>
        <p>Criado <span>voluntariamente</span> para reunir as informa√ß√µes em um mesmo local.</p>
      </div>
      <div>Criado por Vin√≠cius Oliveira ¬Æ.</div>

    </footer>

  </section>
  <script src="./funcoes.js"></script>

  <script type="module">
    // Importa√ß√£o de componentes do banco de dados
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
    import { query, getDatabase, ref, child, get, set, update, remove, orderByKey, orderByChild } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";
    import { orderByValue, limitToLast, limitToFirst, equalTo, startAt } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

    // Configura√ß√µes da conex√£o do banco de dados
    const firebaseConfig = {
      apiKey: "AIzaSyBxnFt-BFIPOzLBHGIKCO2OZgNCpx0Ufbo",
      authDomain: "meetnews-1c4bf.firebaseapp.com",
      projectId: "meetnews-1c4bf",
      storageBucket: "meetnews-1c4bf.appspot.com",
      messagingSenderId: "623938736140",
      appId: "1:623938736140:web:5cd1c5529f81c793e15e29"
    };

    // Realiza a conex√£o com o banco
    const app = initializeApp(firebaseConfig);
    const db  = getDatabase();

    // Carrega as os compenentes nas vari√°veis
    let Lname  = document.getElementById('nome');
    let btn    = document.getElementById('AddBtn');
    let btnRet = document.getElementById('Retorna');
    let id     = crypto.randomUUID();

    //Fun√ß√£o que grava os dados no banco.
    function addData() {
      set(ref(db, 'Postagens/' + id), {

        data: '21/03/2023',
        titulo: 'Breaking news',
        conteudo: '<p>Sed sunt quam quo suscipit accusantiumest voluptatum ex commodi libero est sunt enim. Qui quae autem <em>Et repellat aut quidem sequi aut facere porro sit laboriosam quia</em> a nulla consequatur eos amet sunt? Qui pariatur nihil sed commodi nisiest tempore. Ut repellendus galisum et excepturi ametEum maiores quo aliquam consequuntur et ipsa doloremque ut dicta illum a dolores explicabo. Ea ipsum voluptatemEst quia ab voluptatem tempore ut perferendis doloribus aut debitis officiis. Sed quia provident est molestiae vitaeSit blanditiis. 33 saepe beatae ut laboriosam doloremrem blanditiis. Eum praesentium similique id mollitia quissit quia quo nihil dolorum. Ut provident quiaEum fuga et deserunt praesentium id aperiam nostrum qui tenetur nulla aut aliquam voluptatum ut corporis voluptatum. Ea libero quidem <a href="https://www.loremipzum.com" target="_blank">Ut quia aut internos temporibus est Quis esse</a> in quia rerum sit maxime quia. Sed deleniti earumA pariatur sed cumque quas. </p><p>Ea architecto ducimusUt consequatur et blanditiis atque. Qui possimus modiA excepturi et iure voluptas qui quaerat expedita ut corporis blanditiis. Ut illum voluptatibusEos exercitationem id veritatis debitis ea necessitatibus quia ex nesciunt ducimus. Quo quis accusantium qui error tempore <strong>Vel repellendus aut veniam dolores a tempore dolorem vel sequi iste</strong>. Eos voluptas eius eos provident dolorum <a href="https://www.loremipzum.com" target="_blank">Qui soluta et nobis quis</a> eum aliquam provident sit sapiente quaerat a molestias laborum. In dicta quae qui enim dolorEt voluptas ut omnis alias ea nobis internos ut dolores unde in obcaecati exercitationem. Vel architecto ipsamQuo libero et quasi suscipit id omnis adipisci. In similique nobis non voluptates quiaab recusandae non magnam tempore id magnam magni. </p><dl><dt><dfn>At deserunt temporibus! </dfn></dt><dd>Et provident dolorem aut labore dolores ut omnis quia eum repudiandae voluptas. </dd><dt><dfn>Aut quos Quis eos illo voluptas. </dfn></dt><dd>Aut quos modi eum sunt accusantium. </dd></dl><blockquote cite="https://www.loremipzum.com">Aut molestiae illum ut recusandae necessitatibus in totam quia et perspiciatis galisum et dolores veritatis. </blockquote><p>Ex porro animi <a href="https://www.loremipzum.com" target="_blank">Vel laboriosam et expedita fuga ut totam facere</a>. Qui Quis quod aut nihil reprehenderitet eligendi ut distinctio rerum. Eum repellendus dolorumEos sunt sed ratione consequatur in assumenda libero. Est quidem impedit et dolores iste <strong>Nam internos qui voluptate rerum ut odit voluptatem ea voluptate deserunt</strong> qui cupiditate doloremque. Ab tempora cumque ab molestiae sapienteQui maiores ut asperiores impedit At temporibus inventore et soluta officiis aut rerum aliquid? Aut aspernatur voluptatibusAut sint et accusantium harum non perspiciatis natus ad velit unde eos quibusdam quae ex tempora ipsum. Eos quia doloresEa Quis in aspernatur Quis At voluptas sapiente aut nesciunt dolores. Et culpa ipsa ex ratione omnisid odit ut autem laudantium. Sed consequatur eligendi id cupiditate dictaea dolorem. Et nihil assumendaRem voluptate sed officia harum ab similique repellendus est voluptates quod ut nulla dolorum sit nemo voluptatem? Aut voluptas dolorum aut dolorem Quis33 fugiat non ipsam laborum. </p><ol><li>Ut optio quos non laudantium debitis sed explicabo repudiandae. </li><li>At autem placeat id quam dolor ut nihil quia. </li></ol><ul><li>Ut adipisci distinctio ab numquam alias. </li><li>Et corporis minima in explicabo fuga! </li><li>Et quos inventore eum voluptate voluptatum. </li></ul><pre><code>&lt;!-- Qui maiores provident est error rerum. --&gt;<br>&lt;voluptatibus&gt;Quo accusantium vitae eum assumenda animi eum aliquam perferendis.&lt;/voluptatibus&gt;<br>&lt;qui&gt;Aut galisum eveniet ea iste doloremque!&lt;/qui&gt;<br>&lt;internos&gt;Quo explicabo nemo non rerum accusantium qui dolore tempore.&lt;/internos&gt;<br>&lt;neque&gt;Et omnis explicabo.&lt;/neque&gt;<br></code></pre>'

      }).then(() => {
        alert("Gravado com sucesso!");
        window.location.reload(true);
      }).catch(() => {
        alert("N√£o gravou! Verifique.");
      })
    }

    //Fun√ß√£o que obtem os dados do banco.
    document.addEventListener('DOMContentLoaded', function RetData() {

      //Constantes que recebem o banco de dados.
      const dbRef = ref(db);
      const recentPostsRef = query(ref(db, 'Postagens'));

      //Varre os dados do banco.
      get(recentPostsRef)
        .then((snapshot) => {

          //Crio um array que receber√° os valores recebidos do banco.
            var noticias = [];
          //Percorro o objeto recebido.
            snapshot.forEach(childSnapshot => {
          //Adiciono os dados no array.  
              noticias.push(childSnapshot.val());
          
          });

          //Nessa parte eu inverto o array como se fosse um order by desc.
            //noticias.reverse();
            noticias.forEach(element => {         


            /* Tratando data [Inicio]. */
            let dataExt = element.data;
            //Extraindo o dia da data  
            let dia = dataExt.slice(0, 2);
            let mes = dataExt.substr(3, 2);
            let ano = dataExt.substr(6, 4);
            let mesExtenso;

            //Percorro pelo m√™s e o apresento pelo nome do m√™s.
            switch (mes) {
              case mes     = "01":
                mesExtenso = 'Janeiro';
                break;
              case mes     = "02":
                mesExtenso = 'Fevereiro';
                break;
              case mes     = "03":
                mesExtenso = 'Mar√ßo';
                break;
              case mes     = "04":
                mesExtenso = 'Abril';
                break;
              case mes     = "05":
                mesExtenso = 'Maio';
                break;
              case mes     = "06":
                mesExtenso = 'Junho';
                break;
              case mes     = "07":
                mesExtenso = 'Julho';
                break;
              case mes     = "08":
                mesExtenso = 'Agosto';
                break;
              case mes     = "09":
                mesExtenso = 'Setembro';
                break;
              case mes     = "10":
                mesExtenso = 'Outubro';
                break;
              case mes     = "11":
                mesExtenso = 'Novembro';
                break;
              case mes     = "12":
                mesExtenso = 'Dezembro';
                break;
            }

            //Coloco a data tratada em uma vari√°vel
            let dataTratada = dia + ' ' + 'de' + ' ' + mesExtenso + ' ' + 'de' + ' ' + ano;

            /* Fim tratando data */

            /* Criando arquitetura de exibi√ß√£o dos dados. [Inicio]*/
            var divPostContainer = document.createElement('div');
            divPostContainer.className = 'post-container';

            var divPost = document.createElement('div');
            divPost.className = 'post';

            var dateP = document.createElement('p');
            dateP.className = 'date';
            dateP.innerHTML = dataTratada;

            var postBr = document.createElement('br');
            var tituloPost = document.createElement('h1');
            tituloPost.innerHTML = element.titulo;

            var contentPost = document.createElement('div');
            contentPost.className = 'post-content';

            var conteudoSaltaLinha = document.createElement('br');
            var conteudoParagrafo  = document.createElement('p');
            var conteudoUnderLine  = document.createElement('hr');
            var btnAtualiza        = document.createElement('btn');
            var btnDeleta          = document.createElement('btn');

            var contentAcoes = document.createElement('div');
            btnAtualiza.innerHTML = 'Teste';
            btnDeleta.innerHTML   = 'Teste';

            conteudoParagrafo.innerHTML = element.conteudo;
            /* Criando arquitetura de exibi√ß√£o dos dados. [Fim]*/

            /* Montando no DOM a estrutura criada [Inicio] */
            document.getElementById('contentPost').appendChild(divPost);
            divPost.appendChild(dateP);
            divPost.appendChild(postBr);
            divPost.appendChild(btnAtualiza);
            divPost.appendChild(btnDeleta);
            divPost.appendChild(tituloPost);
            divPost.appendChild(contentPost);
            contentPost.appendChild(conteudoSaltaLinha);
            contentPost.appendChild(conteudoParagrafo);
            contentPost.appendChild(conteudoUnderLine);
            /* Montando no DOM a estrutura criada [Fim] */

          });
       });
    },false);

    btn.addEventListener('click', addData);
   // btnRet.addEventListener('click', RetData());

  </script>
</body>

</html>